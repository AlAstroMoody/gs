import{C as j,r as h,c as x,j as P,o as t,a as u,b as d,e as c,w as N,f as r,d as S,t as b,v as w,n as T,F as B,i as F,l as y,s as z,u as A,T as $,x as L}from"./index.71477777.js";import{s as k}from"./store.36b1722c.js";import M from"./LoupeIcon.3f8ac168.js";import{_ as I}from"./AppFilter.5d4dd467.js";import{_ as O}from"./AppPopup.d158c8de.js";import D from"./FilterIcon.a1f66955.js";import"./useGoblinState.1468cd0a.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./ExitIcon.786b1caa.js";const E={key:0,class:"text-orange-300"},H={key:0,class:"pl-3"},V={__name:"AppCraftItem",props:{item:{default:()=>{},type:Object},count:{type:Number,default:0}},setup(m){var v;const f=m,{item:l}=j(f),n=h(!1),a=x(()=>{var p;return!!((p=o==null?void 0:o.parents)!=null&&p.length)}),_=()=>{a.value&&(n.value=!n.value)},o=k.currentItem("items",((v=l.value)==null?void 0:v.id)||0);return(p,C)=>{var s;const g=P("router-link");return t(),u("ol",null,[d("div",{class:T([{"font-bold":r(a)},"flex items-center"]),onClick:_},[c(g,{to:`/item/${r(l).id}`,class:"mr-2"},{default:N(()=>[c(M)]),_:1},8,["to"]),S(" "+b(m.count?`${m.count}\u0448\u0442`:"")+" "+b(r(l).name)+" ",1),r(a)?(t(),u("span",E," [ "+b(n.value?"-":"+")+" ] ",1)):w("",!0)],2),r(a)&&n.value?(t(),u("ul",H,[(t(!0),u(B,null,F((s=r(o))==null?void 0:s.parents,(e,i)=>(t(),y(V,{count:Number(r(o).parents_count[e.id]||0),key:i,item:e},null,8,["count","item"]))),128))])):w("",!0)])}}},K={class:"flex w-full justify-between px-2 pt-4 pb-20"},R={class:"opacity-1 fixed right-8 top-8 rounded border border-silver bg-gray p-4"},W={class:"opacity-1 fixed right-4 top-4 rounded border border-silver bg-gray p-2"},q={class:"opacity-1 fixed right-4 top-8 rounded-lg border border-silver bg-gray p-4"},se={__name:"CraftPage",async setup(m){let f,l;const n=x(()=>k.entities.items);n.value.length||([f,l]=z(()=>k.setItems("items")),await f,l());const a=h(n.value),_=g=>a.value=g,o=h(null),v=()=>o.value.open(),{width:p}=A(),C=x(()=>["xxs","xs","sm"].includes(p.value));return(g,s)=>(t(),u("main",K,[d("ul",null,[(t(!0),u(B,null,F(a.value.filter(e=>{var i;return(i=e==null?void 0:e.parents)==null?void 0:i.length}).sort((e,i)=>e.level-i.level),e=>(t(),y(V,{item:e,key:e.id},null,8,["item"]))),128))]),r(C)?(t(),y($,{key:1,to:"body"},[d("div",W,[c(D,{color:"silver",onClick:v,width:40,height:40}),c(O,{ref_key:"popup",ref:o,onWheel:s[2]||(s[2]=L(()=>{},["stop"]))},{default:N(()=>[d("div",q,[c(I,{onFilteredItems:s[1]||(s[1]=e=>_(e))})])]),_:1},512)])])):(t(),y($,{key:0,to:"body"},[d("div",R,[c(I,{onFilteredItems:s[0]||(s[0]=e=>_(e))})])]))]))}};export{se as default};
