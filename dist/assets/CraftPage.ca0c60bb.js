import{D as P,r as x,c as $,w as N,j as S,o as t,a as d,b as f,e as m,l as B,f as a,d as T,t as h,y as k,n as z,F,i as I,k as v,u as D,T as w,z as L}from"./index.725b42b6.js";import{u as V}from"./useState.993c58d5.js";import M from"./LoupeIcon.8d46d99f.js";import{_ as C}from"./AppFilter.b65d34ea.js";import{_ as O}from"./AppPopup.ceb713f2.js";import E from"./FilterIcon.3db8cf4b.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./ExitIcon.46fd1ca0.js";const H={key:0,class:"text-orange-300"},K={key:0,class:"pl-3"},j={__name:"AppCraftItem",props:{item:{default:()=>{},type:Object},count:{type:Number,default:0}},async setup(y){let s,_;const g=y,{item:o}=P(g),l=x(!1),i=$(()=>{var r,p;return!!((p=(r=u==null?void 0:u.value)==null?void 0:r.parents)!=null&&p.length)}),b=()=>{i.value&&(l.value=!l.value)},{currentItem:u}=([s,_]=N(()=>{var r;return V({entity:"items",id:((r=o==null?void 0:o.value)==null?void 0:r.id)||0})}),s=await s,_(),s);return(r,p)=>{var e;const n=S("router-link");return t(),d("ol",null,[f("div",{class:z([{"font-bold":a(i)},"flex items-center"]),onClick:b},[m(n,{to:`/item/${a(o).id}`,class:"mr-2"},{default:B(()=>[m(M)]),_:1},8,["to"]),T(" "+h(y.count?`${y.count}\u0448\u0442`:"")+" "+h(a(o).name)+" ",1),a(i)?(t(),d("span",H," [ "+h(l.value?"-":"+")+" ] ",1)):k("",!0)],2),a(i)&&l.value?(t(),d("ul",K,[(t(!0),d(F,null,I((e=a(u))==null?void 0:e.parents,(c,A)=>(t(),v(j,{count:Number(a(u).parents_count[c.id]||0),key:A,item:c},null,8,["count","item"]))),128))])):k("",!0)])}}},R={class:"flex w-full justify-between px-2 pt-4 pb-20"},W={class:"opacity-1 fixed right-8 top-8 rounded border border-silver bg-gray p-4"},q={class:"opacity-1 fixed right-4 top-4 rounded border border-silver bg-gray p-2"},G={class:"opacity-1 fixed right-4 top-8 rounded-lg border border-silver bg-gray p-4"},se={__name:"CraftPage",async setup(y){let s,_;const{entities:g}=([s,_]=N(()=>V({entity:"items"})),s=await s,_(),s),o=x(g),l=p=>o.value=p,i=x(null),b=()=>i.value.open(),{width:u}=D(),r=$(()=>["xxs","xs","sm"].includes(u.value));return(p,n)=>(t(),d("main",R,[f("ul",null,[(t(!0),d(F,null,I(o.value.filter(e=>{var c;return(c=e==null?void 0:e.parents)==null?void 0:c.length}).sort((e,c)=>e.level-c.level),e=>(t(),v(j,{item:e,key:e.id},null,8,["item"]))),128))]),a(r)?(t(),v(w,{key:1,to:"body"},[f("div",q,[m(E,{color:"silver",onClick:b,width:40,height:40}),m(O,{ref_key:"popup",ref:i,onWheel:n[2]||(n[2]=L(()=>{},["stop"]))},{default:B(()=>[f("div",G,[m(C,{onFilteredItems:n[1]||(n[1]=e=>l(e))})])]),_:1},512)])])):(t(),v(w,{key:0,to:"body"},[f("div",W,[m(C,{onFilteredItems:n[0]||(n[0]=e=>l(e))})])]))]))}};export{se as default};
