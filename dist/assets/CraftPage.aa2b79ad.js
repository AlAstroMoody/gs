import{t as B,r as k,i as P,h as F,s as I,j as T,a as t,c as m,b as y,e as _,v as V,k as u,d as W,l as w,q as C,n as A,F as j,p as z,m as x,w as L,o as O,J as $,T as N,y as S}from"./index.7d6f281d.js";import q from"./LoupeIcon.460ec3ea.js";import{_ as D}from"./AppPopup.ae81e443.js";import E from"./FilterIcon.ea36fef9.js";import"./ExitIcon.9e05b61c.js";const H={key:0,class:"text-orange-300"},J={key:0,class:"pl-3"},M={__name:"AppCraftItem",props:{item:{default:()=>{},type:Object},count:{type:Number,default:0}},async setup(f){let c,n;const b=f,{item:r}=B(b),p=k(!1),l=P(()=>{var a,d;return!!((d=(a=o==null?void 0:o.value)==null?void 0:a.parents)!=null&&d.length)}),g=()=>{l.value&&(p.value=!p.value)},{currentItem:o}=([c,n]=F(()=>{var a;return I({entity:"items",id:((a=r==null?void 0:r.value)==null?void 0:a.id)||0})}),c=await c,n(),c);return(a,d)=>{var i;const v=T("router-link");return t(),m("ol",null,[y("div",{class:A([{"font-bold":u(l)},"flex items-center"]),onClick:g},[_(v,{to:`/item/${u(r).id}`,class:"mr-2"},{default:V(()=>[_(q)]),_:1},8,["to"]),W(" "+w(f.count?`${f.count}\u0448\u0442`:"")+" "+w(u(r).name)+" ",1),u(l)?(t(),m("span",H," [ "+w(p.value?"-":"+")+" ] ",1)):C("",!0)],2),u(l)&&p.value?(t(),m("ul",J,[(t(!0),m(j,null,z((i=u(o))==null?void 0:i.parents,(s,e)=>(t(),x(M,{count:Number(u(o).parents_count[s.id]||0),key:e,item:s},null,8,["count","item"]))),128))])):C("",!0)])}}},K={class:"flex justify-between pt-4 pb-20"},R={class:"fixed right-8 top-8 rounded bg-gray p-4 opacity-1 border border-silver"},G={class:"fixed right-4 top-4 rounded bg-gray p-2 opacity-1 border border-silver"},Q={class:"fixed right-4 top-8 rounded-lg bg-gray p-4 opacity-1 border border-silver"},te={__name:"CraftPage",props:{appWidth:{default:0,type:Number}},emits:["resize"],async setup(f,{emit:c}){let n,b;const r=f,{entities:p}=([n,b]=F(()=>I({entity:"items"})),n=await n,b(),n),l=i=>{g.value=i,c("resize")},g=k(p),o=k(null),a=()=>{o.value.open()},{appWidth:d}=B(r),v=k(!1);return L(d,i=>{v.value=i<768}),O(()=>v.value=d.value<768),(i,s)=>(t(),m("main",K,[y("ul",null,[(t(!0),m(j,null,z(g.value.filter(e=>{var h;return(h=e==null?void 0:e.parents)==null?void 0:h.length}).sort((e,h)=>e.level-h.level),e=>(t(),x(M,{item:e,key:e.id},null,8,["item"]))),128))]),v.value?(t(),x(N,{key:1,to:"body"},[y("div",G,[_(E,{color:"silver",onClick:a,width:40,height:40}),_(D,{ref_key:"popup",ref:o,onWheel:s[2]||(s[2]=S(()=>{},["stop"]))},{default:V(()=>[y("div",Q,[_($,{onFilteredItems:s[1]||(s[1]=e=>l(e))})])]),_:1},512)])])):(t(),x(N,{key:0,to:"body"},[y("div",R,[_($,{onFilteredItems:s[0]||(s[0]=e=>l(e))})])]))]))}};export{te as default};
