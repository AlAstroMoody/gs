import{c as C,r as m,o as b,a as _,b as w,t as V,F as D,i as $,f as L,v as O,C as X,D as z,E as A,G as N,n as R,x as F,y as W,s as I,H,I as U,d as k,e as M}from"./index.71477777.js";import{s as x}from"./store.36b1722c.js";const G={class:"bg-gray rounded-2xl p-2 border-silver border"},P={key:0,class:"opacity-100"},j=["onClick"],q={__name:"AppCommonSelect",props:{options:{default:()=>[],type:Array},defaultValue:{default:"\u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",type:String}},emits:["getOption"],setup(f,{emit:c}){const n=f,d=C(()=>[{name:n.defaultValue}].concat(n.options).filter(t=>{var l;return t.name!==((l=a.value)==null?void 0:l.name)})),e=m(!1),o=()=>{e.value=!e.value,e.value||i()},v=()=>e.value?null:h(),p=t=>{i(),e.value=!e.value,t||t===0?a.value=n.options.find(l=>(l==null?void 0:l.id)===t):a.value={name:n.defaultValue,id:void 0},c("getOption",a.value)},a=m({name:"",id:0}),h=()=>{window.addEventListener("click",o)},i=()=>{window.removeEventListener("click",o)};return(t,l)=>{var s;return b(),_("div",G,[w("label",{class:"w-full block",onClick:v},V(((s=a.value)==null?void 0:s.name)||f.defaultValue),1),e.value?(b(),_("div",P,[(b(!0),_(D,null,$(L(d),r=>(b(),_("label",{key:r.id,onClick:S=>p(r.id),class:"py-0 px-2 w-full block transition-all hover:text-primary hover:bg-second"},V(r.name||r),9,j))),128))])):O("",!0)])}}},J=(f,c)=>{let n=null;n||(n=setTimeout(()=>{f(),clearTimeout(n),n=null},c))},K=["onClick"],Q={__name:"AppCommonSlider",props:{custom:{default:()=>"",type:String}},emits:["thumbShift"],setup(f,{emit:c}){const n=f,{custom:d}=X(n),e=m(null),o=m(null),v=m(0),p=m(0),a=m(0),h=m(!1),i=C(()=>a.value-p.value),t=C(()=>{if(o.value&&e.value){const u=Number((i.value/(o.value.clientWidth-e.value.clientWidth)).toPrecision(2));return u>0?u:0}return 0}),l=()=>{c("thumbShift",t.value)};z(i,()=>{J(l,150)});const s=u=>{u.preventDefault(),h.value||y(),h.value=!0,e.value&&(v.value=u.clientX-e.value.getBoundingClientRect().left),document.addEventListener("mousemove",r),document.addEventListener("mouseup",S)},r=u=>{if(o.value&&e.value){let g=u.clientX-v.value-o.value.getBoundingClientRect().left;g<0&&(g=0);let E=o.value.offsetWidth-e.value.offsetWidth;g>E&&(g=E),e.value.style.left=g+"px",a.value=e.value.getBoundingClientRect().left}},S=()=>{document.removeEventListener("mouseup",S),document.removeEventListener("mousemove",r)},B=u=>{y(),a.value=u.clientX,e.value&&(e.value.style.left=i.value+"px")},T=()=>!1,y=()=>{p.value=o.value.getBoundingClientRect().left,v.value=0,a.value=0,e.value.style.left="0"};return A(()=>{y(),window.addEventListener("resize",y)}),N(()=>{window.removeEventListener("resize",y)}),(u,g)=>(b(),_("div",{class:R(["w-full h-4 rounded-lg",L(d)]),ref_key:"slider",ref:o,onClick:F(B,["self"])},[w("label",{class:"rounded-lg relative left-0 h-6 w-3 -top-1 bg-second block",ref_key:"thumb",ref:e,onMousedown:s,onDragstart:T},null,544)],10,K))}},Y={class:"my-2 flex w-full rounded-2xl border border-solid border-second bg-gray px-3 pl-3 text-second ease-out"},Z=w("label",{for:"input",class:"absolute p-2 duration-300 ease-out"}," \u043F\u043E\u0438\u0441\u043A \u043F\u043E \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u044E ",-1),ee={class:"flex items-center"},ne={__name:"AppFilter",emits:["filteredItems"],async setup(f,{emit:c}){let n,d;const e=W({name:"",level:0,goblins:[]}),o=C(()=>x.entities.items);o.value.length||([n,d]=I(()=>x.setItems("items")),await n,d());const v=C(()=>x.entities.goblins);v.value.length||([n,d]=I(()=>x.setItems("goblins")),await n,d()),c("filteredItems",o.value);const p=t=>{e.level=200*t,i()},a=t=>{e.goblins=[],t.id&&e.goblins.push(t.id),i()},h=t=>{e.name=t.target.value,i()},i=()=>{var l;let t=o.value;e.name&&(t=t.filter(s=>s.name.toLowerCase().includes(e.name.toLowerCase()))),e.level&&(t=t.filter(s=>s.level?s.level>=e.level:null)),(l=e.goblins)!=null&&l.length&&(t=t.filter(s=>s.goblins.some(r=>e.goblins[0]===r.id))),c("filteredItems",t)};return(t,l)=>(b(),_(D,null,[w("div",Y,[H(w("input",{"onUpdate:modelValue":l[0]||(l[0]=s=>e.name=s),placeholder:" ",id:"input",class:"relative z-10 w-full py-4",onInput:l[1]||(l[1]=s=>h(s))},null,544),[[U,e.name]]),Z]),k(" \u0443\u0440\u043E\u0432\u0435\u043D\u044C \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u0430 \u043E\u0442: "+V(Math.round(e.level))+" ",1),w("div",ee,[k(" 0 "),M(Q,{onThumbShift:p,class:"mx-1",custom:"bg-silver"}),k(" 200 ")]),k(" \u0438\u0433\u0440\u043E\u0432\u043E\u0439 \u043A\u043B\u0430\u0441\u0441: "),M(q,{options:L(v),onGetOption:a,"default-value":"--\u0434\u043B\u044F \u0432\u0441\u0435\u0445 \u043A\u043B\u0430\u0441\u0441\u043E\u0432--"},null,8,["options"])],64))}};export{ne as _,Q as a};
