import{M as G,r as c,c as $,j as I,a as o,b as p,d as v,f as l,l as B,y as m,e as O,t as h,x as E,n as V,F as T,i as w,k as _,o as j,C as M,u as P,N as z,T as C}from"./index.8c313583.js";import{g as A}from"./index.af050076.js";import{s as L}from"./store.6ba8c3c6.js";import D from"./LoupeIcon.04e4425c.js";import{_ as N}from"./AppFilter.661cd061.js";import{_ as H}from"./AppPopup.218439ea.js";import{e as F,o as K,b as R,c as W}from"./transitions.c96b8bad.js";import q from"./FilterIcon.bd2488aa.js";import"./useGoblinState.2867a4c4.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./ExitIcon.1749c7c5.js";const J={key:0,class:"text-orange-300"},Q={key:0,class:"pl-3"},S={__name:"AppCraftItem",props:{item:{default:()=>{},type:Object},count:{type:Number,default:0}},setup(g){var d;const y=g,{item:i}=G(y),r=c(!1),s=$(()=>{var n;return!!((n=t==null?void 0:t.parents)!=null&&n.length)}),k=()=>{s.value&&(r.value=!r.value)},t=L.currentItem("items",((d=i.value)==null?void 0:d.id)||0),f=n=>t!=null&&t.count?Number(t.count[n]):0;return(n,x)=>{var a;const b=I("router-link");return o(),p("ol",null,[v("div",{class:V([{"font-bold":s.value},"flex items-center"]),onClick:k},[l(b,{to:`/item/${m(i).id}`,class:"mr-2"},{default:B(()=>[l(D)]),_:1},8,["to"]),O(" "+h(g.count?`${g.count}\u0448\u0442`:"")+" "+h(m(i).name)+" ",1),s.value?(o(),p("span",J," [ "+h(r.value?"-":"+")+" ] ",1)):E("",!0)],2),s.value&&r.value?(o(),p("ul",Q,[(o(!0),p(T,null,w((a=m(t))==null?void 0:a.parents,(e,u)=>(o(),_(S,{count:f(e.id),key:u,item:e},null,8,["count","item"]))),128))])):E("",!0)])}}},U={class:"flex w-full justify-between px-2 pb-20 pt-4"},X={class:"opacity-1 fixed right-4 top-8 rounded-lg border border-silver bg-gray p-4"},ue={__name:"CraftPage",setup(g){const y=$(()=>L.entities.items),i=c(y.value),r=b=>i.value=b,s=c(null),k=()=>s.value.open(),t=c(null),f=c(null),d=c(null);j(()=>{t.value&&F({el:t.value,transformOrigin:"right bottom"}),f.value&&F({el:f.value,transformOrigin:"right bottom"}),M(()=>A.from(d.value,{duration:1,x:-200,autoAlpha:0,ease:"back.out(1)"}))});const{width:n}=P(),x=$(()=>["xxs","xs","sm"].includes(n.value));return(b,a)=>(o(),p("main",U,[v("ul",{ref_key:"list",ref:d},[l(z,{tag:"ol",css:!1,onBeforeEnter:m(K),onEnter:m(R),onLeave:m(W)},{default:B(()=>[(o(!0),p(T,null,w(i.value.filter(e=>{var u;return(u=e==null?void 0:e.parents)==null?void 0:u.length}).sort((e,u)=>e.level-u.level),e=>(o(),_(S,{item:e,key:e.id},null,8,["item"]))),128))]),_:1},8,["onBeforeEnter","onEnter","onLeave"])],512),x.value?(o(),_(C,{key:1,to:"body"},[v("div",{ref_key:"mobileFilter",ref:f,class:"opacity-1 fixed right-4 top-4 rounded border border-silver bg-gray p-2"},[l(q,{color:"silver",onClick:k,width:40,height:40})],512)])):(o(),_(C,{key:0,to:"body"},[v("div",{ref_key:"filter",ref:t,class:"opacity-1 fixed right-8 top-8 rounded border border-silver bg-gray p-4"},[l(N,{onFilteredItems:a[0]||(a[0]=e=>r(e))})],512)])),x.value?(o(),_(C,{key:2,to:"body"},[l(H,{ref_key:"popup",ref:s},{default:B(()=>[v("div",X,[l(N,{onFilteredItems:a[1]||(a[1]=e=>r(e))})])]),_:1},512)])):E("",!0)]))}};export{ue as default};
