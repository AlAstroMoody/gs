import{E as O,r as p,c as $,k as V,a as o,b as m,d as _,f as l,w as B,g as s,e as j,t as w,x as N,n as A,F as S,j as T,l as v,v as P,o as z,u as M,N as D,T as E}from"./index.55f217f3.js";import{e as I,g as H,o as K,b as R,c as W}from"./transitions.b67b51ec.js";import{s as F}from"./store.fd9f566f.js";import q from"./LoupeIcon.8e09daec.js";import{_ as L}from"./AppFilter.0180bdd0.js";import{_ as J}from"./AppPopup.e51ebefe.js";import Q from"./FilterIcon.98f130d4.js";import"./useGoblinState.14933650.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./ExitIcon.270d2fb6.js";const U={key:0,class:"text-orange-300"},X={key:0,class:"pl-3"},G={__name:"AppCraftItem",props:{item:{default:()=>{},type:Object},count:{type:Number,default:0}},setup(g){var u;const b=g,{item:i}=O(b),n=p(!1),a=$(()=>{var r;return!!((r=t==null?void 0:t.parents)!=null&&r.length)}),y=()=>{a.value&&(n.value=!n.value)},t=F.currentItem("items",((u=i.value)==null?void 0:u.id)||0),h=r=>t!=null&&t.count?Number(t.count[r]):0;return(r,x)=>{var f;const C=V("router-link");return o(),m("ol",null,[_("div",{class:A([{"font-bold":s(a)},"flex items-center"]),onClick:y},[l(C,{to:`/item/${s(i).id}`,class:"mr-2"},{default:B(()=>[l(q)]),_:1},8,["to"]),j(" "+w(g.count?`${g.count}\u0448\u0442`:"")+" "+w(s(i).name)+" ",1),s(a)?(o(),m("span",U," [ "+w(n.value?"-":"+")+" ] ",1)):N("",!0)],2),s(a)&&n.value?(o(),m("ul",X,[(o(!0),m(S,null,T((f=s(t))==null?void 0:f.parents,(d,c)=>(o(),v(G,{count:h(d.id),key:c,item:d},null,8,["count","item"]))),128))])):N("",!0)])}}},Y={class:"flex w-full justify-between px-2 pt-4 pb-20"},Z={class:"opacity-1 fixed right-4 top-8 rounded-lg border border-silver bg-gray p-4"},ce={__name:"CraftPage",async setup(g){let b,i;const n=$(()=>F.entities.items);n.value.length||([b,i]=P(()=>F.setItems("items")),await b,i());const a=p(n.value),y=d=>a.value=d,t=p(null),h=()=>t.value.open(),u=p(null),r=p(null),x=p(null);z(()=>{u.value&&I({el:u.value,transformOrigin:"right bottom"}),r.value&&I({el:r.value,transformOrigin:"right bottom"}),H.from(x.value,{duration:1,x:-200,autoAlpha:0,ease:"back.out(1)"})});const{width:C}=M(),f=$(()=>["xxs","xs","sm"].includes(C.value));return(d,c)=>(o(),m("main",Y,[_("ul",{ref_key:"list",ref:x},[l(D,{tag:"ol",css:!1,onBeforeEnter:s(K),onEnter:s(R),onLeave:s(W)},{default:B(()=>[(o(!0),m(S,null,T(a.value.filter(e=>{var k;return(k=e==null?void 0:e.parents)==null?void 0:k.length}).sort((e,k)=>e.level-k.level),e=>(o(),v(G,{item:e,key:e.id},null,8,["item"]))),128))]),_:1},8,["onBeforeEnter","onEnter","onLeave"])],512),s(f)?(o(),v(E,{key:1,to:"body"},[_("div",{ref_key:"mobileFilter",ref:r,class:"opacity-1 fixed right-4 top-4 rounded border border-silver bg-gray p-2"},[l(Q,{color:"silver",onClick:h,width:40,height:40})],512)])):(o(),v(E,{key:0,to:"body"},[_("div",{ref_key:"filter",ref:u,class:"opacity-1 fixed right-8 top-8 rounded border border-silver bg-gray p-4"},[l(L,{onFilteredItems:c[0]||(c[0]=e=>y(e))})],512)])),s(f)?(o(),v(E,{key:2,to:"body"},[l(J,{ref_key:"popup",ref:t},{default:B(()=>[_("div",Z,[l(L,{onFilteredItems:c[1]||(c[1]=e=>y(e))})])]),_:1},512)])):N("",!0)]))}};export{ce as default};
