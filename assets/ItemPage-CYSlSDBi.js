import{u as G}from"./vue-router-BYyBkGBh.js";import{_ as H}from"./BaseButton-CoLf6h4j.js";import{a as I,v as s,B as d,x as t,E as n,P as R,u as a,G as m,e as v,z as P,I as y,y as c,C as W,A as g,F as J,L as k,O as b}from"./@vue-DCWQxOwg.js";import{u as K,s as U}from"./index-BjCCohTT.js";import{_ as Q}from"./QuestionIcon-BreqjpXt.js";import{_ as X}from"./ThePreloader-ChSG7DZz.js";import"./yandex-metrika-vue3-BLhOeDw4.js";import"./@vueuse-C3BhMRlV.js";import"./firebase-H5BtYLRW.js";import"./@firebase-BA115Y1H.js";import"./idb-BXWtuYvb.js";const Y={key:0,class:"fixed bg-silver right-4 top-4 w-80 text-purple z-20 rounded-xl p-4"},Z={__name:"BaseInfoPopup",setup($,{expose:_}){const u=I(!1),r=I("");function f(e){r.value=e,u.value=!0,setTimeout(()=>u.value=!1,5e3)}return _({show:f}),(e,x)=>u.value?(t(),s("div",Y,n(r.value),1)):d("",!0)}},w={strength:"сила",agility:"ловкость",intelligence:"разум",attack:"урон",defence:"защита",visibility:"обзор",luck:"удача",hp:"ХП",mp:"МП",resist:"сопротивление магии",hp_regeneration:"регенерация здоровья",mp_regeneration:"регенерация маны",mp_regen:"регенерация маны",stealth_detection:"обнаружение невидимок",as:"скорость атаки",ms:"скорость бега",manaburn:"каждый удар сжигает",evade:"уклонение",aura:"аура",active:"актив",distant_resist:"снижение урона",critical_chance:"шанс крита:",block_chance:"шанс блока:",mainParam:"основной параметр"},ee={key:0},te={key:1},se={key:0},ae={key:1},ne={key:0,class:"text-green"},le={key:2},oe={key:3},re={key:4},ie={__name:"ItemParams",props:{item:{default:()=>{},type:Object},param:{default:"",type:String},equalityParams:{default:!1,type:Boolean}},setup($){const _=$,{item:u,param:r,equalityParams:f}=R(_);return(e,x)=>(t(),s("li",null,[a(f)&&a(r)==="strength"?(t(),s("div",ee,"все статы: "+n(a(u).params.strength),1)):a(u).params[a(r)]&&a(w)[a(r)]?(t(),s("div",te,[a(r)==="manaburn"?(t(),s("span",se,n(a(w)[a(r)])+" "+n(a(u).params[a(r)])+" маны противнику ",1)):a(r)==="critical_chance"?(t(),s("span",ae,[m(n(a(w)[a(r)])+" "+n(a(u).params[a(r)])+"% на x"+n(a(u).params.critical_value)+". ",1),a(u).params.sniper_coef?(t(),s("span",ne," Шанс у снайпера: "+n((a(u).params[a(r)]*a(u).params.sniper_coef).toFixed(1))+"%",1)):d("",!0)])):a(r)==="block_chance"?(t(),s("span",le,n(a(u).params[a(r)])+"% на блок "+n(a(u).params.block_value)+" урона ",1)):(t(),s("span",oe,n(a(w)[a(r)])+": "+n(a(u).params[a(r)]),1)),["as","mp_regeneration","resist","distant_resist","evade"].includes(a(r))?(t(),s("span",re,"%")):d("",!0)])):d("",!0)]))}},ue={key:1},ce={key:2,class:"flex w-full justify-between py-4"},de={class:"h-[calc(100vh-350px)] pb-20 overflow-y-auto scrollbar-custom"},_e={class:"text-3xl xxl:text-6xl"},me={class:"my-2 flex flex-wrap items-center"},ve={class:"flex w-full flex-wrap items-center xs:w-auto"},pe=["src"],he={class:"text-md ml-2 flex h-fit flex-1 justify-end whitespace-nowrap text-second"},ye={class:"ml-4 flex flex-col content-center justify-center"},fe={key:0},xe={key:1},ge={key:2},ke={class:"text-lg text-red"},be={key:3},we={key:4},$e={key:5},Pe=["innerHTML"],Ie={key:0,class:"my-2 w-full text-white lg:text-xl"},Be={key:1,class:"w-full text-lg text-white"},Ce={class:"text-green"},je={key:2,class:"text-orange"},qe={key:3,class:"text-orange"},Me={key:4,class:"my-2 w-full"},Ne={key:5,class:"my-1 w-full p-2"},Se={class:"text-red hover:border-b"},Te={key:0},Fe={key:1},Le={class:"w-full"},Oe={key:0,class:"border-bg-silver rounded-lg border p-2 w-fit"},Ue={class:"text-red hover:border-b"},Ve={key:0},ze={key:1},De={key:6,class:"my-2 rounded-lg border border-silver p-2"},Ae={class:"text-red hover:border-b"},Ee={key:0},Ge={key:1},st={__name:"ItemPage",setup($){const{user:_,addItem:u}=K(),r=G(),f=v(()=>U.entities.items),e=v(()=>U.currentItem("items",r.params.id)),x=v(()=>{var l,o;return((l=e.value)==null?void 0:l.goblins)&&!((o=e.value)!=null&&o.goblins.includes(_.goblin.name))}),B=v(()=>{var l;return(l=e.value.notUsed)==null?void 0:l.some(o=>_.inventory.map(h=>h.id).includes(o.id))}),V=v(()=>B.value?"нельзя добавить":x.value?"не подходит гоблину":_.inventory.length===6?"инвентарь переполнен":C.value?`не более ${e.value.max_count||1} шт.`:"добавить в инвентарь"),C=v(()=>{const l=_.inventory.filter(o=>o.id===e.value.id);return!e.value.max_count&&l.length===1?!0:e.value.max_count<=l.length}),z=()=>{_.inventory.length||D(),!(C.value||x.value||B.value)&&_.inventory.length<6&&u(e.value)},j=I(null),D=()=>{j.value.show("В связи с изменением игровых механик, подсчёт параметров гоблина временно работает некорректно")},q=l=>{var o;return(o=e.value)!=null&&o.count&&e.value.count[l]?`${e.value.count[l]}шт`:""},A=l=>l==="Ангельская кузница"?"text-yellow":l==="Вневременная кузня"?"text-purple":l==="Великая кузница"?"text-orange":l==="Котелок Попса"?"text-green":l==="Демоническая кузница"?"text-red":"",M=v(()=>e.value.params.strength===e.value.params.agility&&e.value.params.agility===e.value.params.intelligence),E=v(()=>Object.keys(e.value.params).sort(l=>["strength","agility","intelligence"].includes(l)?-1:1).filter(l=>M.value?!["agility","intelligence"].includes(l):!0));return(l,o)=>{var N,S,T,F,L,O;const h=J("router-link");return f.value.length?e.value?(t(),s("div",ce,[y(Z,{ref_key:"popup",ref:j},null,512),c("div",de,[c("div",_e,n(e.value.name),1),c("div",me,[c("div",ve,[e.value.src?(t(),s("img",{key:0,src:e.value.src,alt:"logo",class:"h-24 w-24"},null,8,pe)):(t(),P(Q,{key:1,color:"red"})),c("div",he,[y(H,{onClick:z,text:V.value},null,8,["text"])]),c("div",ye,[((N=e.value)==null?void 0:N.level)>1?(t(),s("div",fe,"требуемый уровень: "+n(e.value.level),1)):(t(),s("div",xe,"Нет ограничения по уровню")),(S=e.value.goblins)!=null&&S.length?(t(),s("div",ge,[o[0]||(o[0]=m(" Только для класса: ")),c("span",ke,n(e.value.goblins.join(", ")),1)])):(t(),s("div",be,"Подходит для всех классов")),e.value.craft?(t(),s("div",we,[o[1]||(o[1]=m(" крафт в: ")),c("span",{class:W(A(e.value.craft))},n(e.value.craft),3)])):d("",!0),e.value.boss?(t(),s("div",$e,[o[2]||(o[2]=m(" Босс: ")),y(h,{to:`/boss?name=${(T=e.value.boss)==null?void 0:T.name}`,class:"mr-2 text-red"},{default:g(()=>{var i;return[m(n((i=e.value.boss)==null?void 0:i.name),1)]}),_:1},8,["to"])])):d("",!0)])]),c("div",{class:"w-full text-white lg:text-xl",innerHTML:e.value.description},null,8,Pe),e.value.max_count?(t(),s("div",Ie," Не более "+n(e.value.max_count)+" шт. ",1)):d("",!0),e.value.source?(t(),s("div",Be,[o[3]||(o[3]=m(" Где достать: ")),c("span",Ce,n(e.value.source),1)])):d("",!0),e.value.isMedicDD?(t(),s("div",je,"Медик-ДД")):d("",!0),e.value.isMedicSupport?(t(),s("div",qe,"Медик-сап")):d("",!0),e.value.params?(t(),s("ul",Me,[o[4]||(o[4]=m(" Бонусы предмета: ")),(t(!0),s(k,null,b(E.value,(i,p)=>(t(),P(ie,{key:p,class:"ml-7",item:e.value,param:i,equalityParams:M.value},null,8,["item","param","equalityParams"]))),128))])):d("",!0),(F=e.value.notUsed)!=null&&F.length?(t(),s("div",Ne,[o[5]||(o[5]=m(" Нельзя использовать с: ")),(t(!0),s(k,null,b(e.value.notUsed,(i,p)=>(t(),s("span",{class:"text-md text-end",key:i.id},[y(h,{to:`/item/${i.id}`},{default:g(()=>[c("span",Se,n(q(i.id))+" "+n(i.name),1),p!==e.value.notUsed.length-1?(t(),s("span",Te,", ")):(t(),s("span",Fe,"; "))]),_:2},1032,["to"])]))),128))])):d("",!0),c("div",Le,[(L=e.value.children)!=null&&L.length?(t(),s("div",Oe,[m(' Из предмета "'+n(e.value.name)+'" можно скрафтить: ',1),(t(!0),s(k,null,b(e.value.children,(i,p)=>(t(),s("span",{class:"text-md text-end",key:i.id},[y(h,{to:`/item/${i.id}`},{default:g(()=>[c("span",Ue,n(i.name),1),p!==e.value.children.length-1?(t(),s("span",Ve,", ")):(t(),s("span",ze,"; "))]),_:2},1032,["to"])]))),128))])):d("",!0)]),(O=e.value.parents)!=null&&O.length?(t(),s("div",De,[m(' Предмет "'+n(e.value.name)+'" крафтится из: ',1),(t(!0),s(k,null,b(e.value.parents,(i,p)=>(t(),s("span",{class:"text-md text-end",key:i.id},[y(h,{to:`/item/${i.id}`},{default:g(()=>[c("span",Ae,n(q(i.id))+" "+n(i.name),1),p!==e.value.parents.length-1?(t(),s("span",Ee,", ")):(t(),s("span",Ge,"; "))]),_:2},1032,["to"])]))),128))])):d("",!0)])])])):(t(),s("div",ue,"Такого предмета нет")):(t(),P(X,{key:0}))}}};export{st as default};
